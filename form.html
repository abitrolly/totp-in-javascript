<!DOCTYPE HTML>
<title>a simple TOTP generator</title>
<meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
#key:invalid { background-color: red; color: pink }
#error { color: red; display: inline-block; line-height: inherit }
#key:invalid ~ #error:empty::after {
	content: 'ERROR: only letters and digits from 2 to 7 allowed'
}
input { width: 100%; box-sizing: border-box; font-size: inherit; display: block }
[value] { text-align: start; max-width: max-content; white-space: normal; margin: 1em 0 }
#code::after { all: initial; margin-left: .5ex; content: attr(title); color: red }
#code[title^=copied]::after { color: green }
#code { font-size: 250%; letter-spacing: .15em; font-family: monospace }

#user, #pw { max-width: 26em; display: block; margin-bottom: 1em; position: relative }
#show { position: absolute; right: 1ex; top: 0; bottom: 0; display: flex; align-items: center; font-size: 80% }
#show::before { background-color: lightgray; content: 'show' }
[type=text] + #show::before { content: 'hide' }
#add { display: none }

.popup :not(#user, #code) { display: none }
.popup #user { font-size: revert; margin: .5em 0 }
.popup #code { all: initial }
.popup #code::after { font-size: 70% }
.popup #add { display: revert; float: right }

</style>

<iframe name=fram style=display:none></iframe>
<form target=fram>

<label for=user>User</label>
<input id=user size=24 autocomplete=username>
<label id=pw>Shared Key
  <input id=key autocomplete=current-password type=password pattern="[a-zA-Z2-7\s]+">
  <div id=show></div>
  <b id=error></b>
</label>
<span id=code>XXXXXX</span>
<a id=add href target=_blank>add key</a>

<input type=button id=generate value="Generate TOTP (and copy it to clipboard)">
<input type=submit value="Save the key (with the browser's password manager)">

<p>The TOTP shared key should be in base32 format, e.g. <code>TK7P33KPE527ZTOX</code> (github) or <code>opid zgaw quda ip7q tj3z izo7 oemp t7dm</code> (google).

<p>The <q>User</q> field is not used for computing the TOTP; its only purpose is to act as a label for the password manager.

<p>If the <q>Save..</q> button does not pop up the <q>Save login/password</q> dialog, look for a key-like icon in the address bar and click on it. If there's no such icon, check if your browser's settings prevent it from saving passwords on this page.
</form>
<script src=form.js></script>
<script src=totp.js></script>
